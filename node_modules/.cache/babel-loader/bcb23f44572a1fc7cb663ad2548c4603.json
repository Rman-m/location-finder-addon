{"ast":null,"code":"import _asyncToGenerator from\"/Users/arman/ip-prj/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/arman/ip-prj/my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/arman/ip-prj/my-app/node_modules/@babel/runtime/regenerator/index.js\";/*global browser*/ /*global url*/import React,{useEffect,useState,useCallback}from\"react\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){var _urlData$country;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),urlData=_useState2[0],setUrlData=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),tabUrl=_useState6[0],setTabUrl=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];useEffect(function(){setLoading(true);browser.tabs.query({currentWindow:true,active:true}).then(function(tabs){var x=new URL(tabs[0].url).hostname;console.log(x);setTabUrl(x);});},[setUrlData]);var fetchApi=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var jsonResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(tabUrl){_context.next=3;break;}throw new Error(\"url is empty\");case 3:_context.next=5;return fetch(\"http://ip-api.com/json/\".concat(tabUrl)).json();case 5:jsonResponse=_context.sent;if(!(jsonResponse.status===\"fail\")){_context.next=8;break;}throw new Error(\"something went wrong\");case 8:setUrlData(jsonResponse);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);setErrorMessage(_context.t0.message);case 14:setLoading(false);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);})),[tabUrl]);useEffect(function(){fetchApi();},[fetchApi]);console.log(\"red\");if(tabUrl===\"\")return/*#__PURE__*/_jsxs(\"h1\",{className:\"app\",children:[\" your location : \",urlData.country,\" \"]});return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:loading?/*#__PURE__*/_jsx(\"p\",{children:\"loading...\"}):(_urlData$country=urlData.country)!==null&&_urlData$country!==void 0?_urlData$country:errorMessage});}export default App;","map":{"version":3,"names":["React","useEffect","useState","useCallback","App","urlData","setUrlData","errorMessage","setErrorMessage","tabUrl","setTabUrl","loading","setLoading","browser","tabs","query","currentWindow","active","then","x","URL","url","hostname","console","log","fetchApi","Error","fetch","json","jsonResponse","status","message","country"],"sources":["/Users/arman/ip-prj/my-app/src/App.js"],"sourcesContent":["/*global browser*/\n/*global url*/\n\nimport React, { useEffect, useState, useCallback } from \"react\";\nfunction App() {\n\tconst [urlData, setUrlData] = useState({});\n\tconst [errorMessage, setErrorMessage] = useState(\"\");\n\tconst [tabUrl, setTabUrl] = useState(\"\");\n\tconst [loading, setLoading] = useState(true);\n\n\tuseEffect(() => {\n\t\tsetLoading(true);\n\t\tbrowser.tabs.query({ currentWindow: true, active: true }).then((tabs) => {\n\t\t\tconst x = new URL(tabs[0].url).hostname;\n\t\t\tconsole.log(x);\n\t\t\tsetTabUrl(x);\n\t\t});\n\t}, [setUrlData]);\n\n\tconst fetchApi = useCallback(async () => {\n\t\ttry {\n      if (!tabUrl) throw new Error(\"url is empty\");\n\t\t\tconst jsonResponse = await fetch(\n\t\t\t\t`http://ip-api.com/json/${tabUrl}`\n\t\t\t).json();\n\t\t\tif (jsonResponse.status === \"fail\")\n\t\t\t\tthrow new Error(\"something went wrong\");\n\t\t\tsetUrlData(jsonResponse);\n\t\t} catch (err) {\n\t\t\tsetErrorMessage(err.message);\n\t\t}\n\t\tsetLoading(false);\n\t}, [tabUrl]);\n\tuseEffect(() => {\n\t\tfetchApi();\n\t}, [fetchApi]);\n\tconsole.log(\"red\");\n\tif (tabUrl === \"\")\n\t\treturn <h1 className=\"app\"> your location : {urlData.country} </h1>;\n\treturn (\n\t\t<div className=\"app\">\n\t\t\t{loading ? <p>loading...</p> : urlData.country ?? errorMessage}\n\t\t</div>\n\t);\n}\n\nexport default App;\n"],"mappings":"mVAAA,kB,CACA,cAEA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,WAArC,KAAwD,OAAxD,C,wFACA,QAASC,CAAAA,GAAT,EAAe,sBACd,cAA8BF,QAAQ,CAAC,EAAD,CAAtC,wCAAOG,OAAP,eAAgBC,UAAhB,eACA,eAAwCJ,QAAQ,CAAC,EAAD,CAAhD,yCAAOK,YAAP,eAAqBC,eAArB,eACA,eAA4BN,QAAQ,CAAC,EAAD,CAApC,yCAAOO,MAAP,eAAeC,SAAf,eACA,eAA8BR,QAAQ,CAAC,IAAD,CAAtC,yCAAOS,OAAP,eAAgBC,UAAhB,eAEAX,SAAS,CAAC,UAAM,CACfW,UAAU,CAAC,IAAD,CAAV,CACAC,OAAO,CAACC,IAAR,CAAaC,KAAb,CAAmB,CAAEC,aAAa,CAAE,IAAjB,CAAuBC,MAAM,CAAE,IAA/B,CAAnB,EAA0DC,IAA1D,CAA+D,SAACJ,IAAD,CAAU,CACxE,GAAMK,CAAAA,CAAC,CAAG,GAAIC,CAAAA,GAAJ,CAAQN,IAAI,CAAC,CAAD,CAAJ,CAAQO,GAAhB,EAAqBC,QAA/B,CACAC,OAAO,CAACC,GAAR,CAAYL,CAAZ,EACAT,SAAS,CAACS,CAAD,CAAT,CACA,CAJD,EAKA,CAPQ,CAON,CAACb,UAAD,CAPM,CAAT,CASA,GAAMmB,CAAAA,QAAQ,CAAGtB,WAAW,sEAAC,uKAEnBM,MAFmB,8BAEL,IAAIiB,CAAAA,KAAJ,CAAU,cAAV,CAFK,8BAGAC,CAAAA,KAAK,kCACLlB,MADK,EAAL,CAEzBmB,IAFyB,EAHA,QAGrBC,YAHqB,oBAMvBA,YAAY,CAACC,MAAb,GAAwB,MAND,+BAOpB,IAAIJ,CAAAA,KAAJ,CAAU,sBAAV,CAPoB,QAQ3BpB,UAAU,CAACuB,YAAD,CAAV,CAR2B,iFAU3BrB,eAAe,CAAC,YAAIuB,OAAL,CAAf,CAV2B,QAY5BnB,UAAU,CAAC,KAAD,CAAV,CAZ4B,qEAAD,GAazB,CAACH,MAAD,CAbyB,CAA5B,CAcAR,SAAS,CAAC,UAAM,CACfwB,QAAQ,GACR,CAFQ,CAEN,CAACA,QAAD,CAFM,CAAT,CAGAF,OAAO,CAACC,GAAR,CAAY,KAAZ,EACA,GAAIf,MAAM,GAAK,EAAf,CACC,mBAAO,YAAI,SAAS,CAAC,KAAd,+BAAsCJ,OAAO,CAAC2B,OAA9C,OAAP,CACD,mBACC,YAAK,SAAS,CAAC,KAAf,UACErB,OAAO,cAAG,iCAAH,mBAAuBN,OAAO,CAAC2B,OAA/B,qDAA0CzB,YADnD,EADD,CAKA,CAED,cAAeH,CAAAA,GAAf"},"metadata":{},"sourceType":"module"}